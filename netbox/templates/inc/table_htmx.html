{% load django_tables2 %}
{% load form_helpers %}
<table{% if table.attrs %} {{ table.attrs.as_html }}{% endif %}>
  {% if table.show_header %}
    <thead>
      <tr>
        {% for column in table.columns %}
          <th {{ column.attrs.th.as_html }}>
            {% if column.is_ordered %}
              <div class="float-end">
                <a href="#"
                   hx-get="{{ table.htmx_url }}{% querystring table.prefixed_order_by_field='' %}"
                   hx-target="closest .htmx-container"
                   {% if not table.embedded %}hx-push-url="true"{% endif %}
                   class="text-danger"
                ><i class="mdi mdi-close"></i></a>
              </div>
            {% endif %}
            {% if table.filterset_form %}
              {% include 'inc/table_header_filter_dropdown.html' with form_field=table.filterset_form|get_filter_field:column.name %}
            {% endif %}
            {% if column.orderable %}
              <a href="#"
                hx-get="{{ table.htmx_url }}{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}"
                hx-target="closest .htmx-container"
                {% if not table.embedded %}hx-push-url="true"{% endif %}
              >{{ column.header }}</a>
            {% else %}
              {{ column.header }}
            {% endif %}
          </th>
        {% endfor %}
      </tr>
    </thead>
  {% endif %}
  <tbody>
    {% for row in table.page.object_list|default:table.rows %}
      <tr {{ row.attrs.as_html }}>
        {% for column, cell in row.items %}
          <td {{ column.attrs.td.as_html }}>{{ cell }}</td>
        {% endfor %}
      </tr>
    {% empty %}
      {% if table.empty_text %}
        <tr>
          <td colspan="{{ table.columns|length }}" class="text-center text-muted">&mdash; {{ table.empty_text }} &mdash;</td>
        </tr>
      {% endif %}
    {% endfor %}
  </tbody>
  {% if table.has_footer %}
    <tfoot>
      <tr>
        {% for column in table.columns %}
          <td>{{ column.footer }}</td>
        {% endfor %}
      </tr>
    </tfoot>
  {% endif %}
</table>
