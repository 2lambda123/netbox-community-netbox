// NetBox-specific Styles and Overrides.

@use 'sass:map';
@use 'sass:math';
//@import './sidenav';
@import './overrides';
@import './utilities';
//@import './variables';

// Style objects with statuses/roles within a table. As of implementation, used for IP addresses
// assigned to interfaces.
table .table-badge-group {
  .table-badge {
    display: block;
    width: min-content;
    font-size: $font-size-sm;
    font-weight: $font-weight-base;

    &:not(.badge) {
      // Apply badge horizontal padding so that IP addresses *not* within a badge appear aligned
      // with IP addresses that *are* within a badge.
      padding: 0 $badge-padding-x;
    }

    &.badge:not(:last-of-type):not(:only-child) {
      margin-bottom: map.get($spacers, 1);
    }
  }
}

pre.change-data {
  padding-right: 0;
  padding-left: 0;

  > span {
    display: block;
    padding-right: $spacer;
    padding-left: $spacer;

    &.added {
      background-color: var(--nbx-change-added);
    }

    &.removed {
      background-color: var(--nbx-change-removed);
    }
  }
}

pre.change-diff {
  border-color: transparent;

  &.change-removed {
    background-color: var(--nbx-change-removed);
  }

  &.change-added {
    background-color: var(--nbx-change-added);
  }
}

div.card-overlay {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  background-color: rgba($white, 0.75);
  border-radius: $border-radius;

  > div.spinner-border {
    width: 6rem;
    height: 6rem;
    color: $secondary;
  }
}

.table-controls {
  display: flex;

  @include media-breakpoint-up(md) {
    // `!important` needed because of inherited margin-bottom from `.col`
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }

  .table-configure {
    justify-content: flex-start;

    @include media-breakpoint-up(md) {
      justify-content: flex-end;
    }
  }

  .form-switch.form-check-inline {
    flex: 1 0 auto;
    font-size: $font-size-sm;
  }
}

// Tabbed content
.nav-tabs {
  background-color: $body-bg;
  .nav-link {
    &:hover {
      // Don't show a bottom-border on a hovered nav link because it overlaps with the .nav-tab border.
      border-bottom-color: transparent;
    }
    &.active {
      // Set the background-color of an active tab to the same color as the .tab-content
      // background-color so it visually indicates which tab is open.
      background-color: $tab-content-bg;
      border-bottom-color: $tab-content-bg;
      // Move the active tab down 1px to overtake the .nav-tabs element's border, but only for that
      // tab. This is an ugly hack, but it works.
      transform: translateY(1px);
    }
  }
}

.tab-content {
  display: flex;
  flex-direction: column;
  padding: $spacer;
}

// Object hierarchy indicators.
.record-depth {
  display: inline;
  font-size: $font-size-base;
  user-select: none;
  opacity: 0.33;

  // Add spacing to the last or only dot.
  span:only-of-type,
  span:last-of-type {
    margin-right: map.get($spacers, 1);
  }
}

// Remove the max-width from image preview popovers as this is controlled on the image element.
.popover.image-preview-popover {
  max-width: unset;
}

/* Markdown widget */
.markdown-widget {
  .nav-link {
    border-bottom: 0;

    &.active {
      background-color: var(--nbx-body-bg);
    }
  }

  .nav-tabs {
    background-color: var(--nbx-pre-bg);
  }
}

// Preformatted text blocks
td pre {
  margin-bottom: 0;
}
pre.block {
  padding: $spacer;
  background-color: var(--nbx-pre-bg);
  border: 1px solid var(--nbx-pre-border-color);
  border-radius: $border-radius;
}

#django-messages {
  position: fixed;
  right: $spacer;
  bottom: 0;
  margin: $spacer;
}

// Page-specific styles.
html {
  // Shade the home page content background-color.
  &[data-netbox-url-name='home'] {
    .content-container,
    .search {
      background-color: $gray-100 !important;
    }
    &[data-netbox-color-mode='dark'] {
      .content-container,
      .search {
        background-color: $darkest !important;
      }
    }
  }

  // Don't show the django-messages toasts on the login screen in favor of the alert component.
  &[data-netbox-url-name='login'] {
    #django-messages {
      display: none;
    }
  }
}
